<!DOCTYPE html>
<html>

<head>
    <title>Tarocchi</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="./assets/style.css">
</head>

<body>
    <div class="wrap">


        <div id="about">

            <h1 class="text-center">Tarocchi</h1>
            <div class="row justify-content-center">
                <p class="col-md-8">
                    about tarocchi Lorem ipsum dolor sit amet consectetur adipisicing elit. Error nobis velit ea quo
                    commodi,
                    minus nihil esse voluptates! Placeat nostrum sapiente voluptates provident earum nisi illo itaque
                    deleniti
                    voluptas ab?
                </p>
            </div>
            <div class="row justify-content-center">
                <button class="btn outline" id="submit">Click For a Reading</button>
            </div>
        </div>

        <div class="cards justify-content-center">
            <div class="mx-auto col-md-8">
                <div id="cardReading">
                </div>
            </div>


        </div>
    </div>
    <footer class="footer navbar-fixed-bottom">
        <div class="text-center">
            <a class="apiLink" href="/api/cards">Card API</a>
        </div>
    </footer>

</body>

<script src="https://code.jquery.com/jquery-3.4.0.js" integrity="sha256-DYZMCC8HTC+QDr5QNaIcfR7VSPtcISykd+6eSmBW5qo="
    crossorigin="anonymous">
    </script>

<script type="text/javascript">

    $("#submit").on("click", function () {
        function runCardsQuery() {
            $.ajax({ url: "/api/cards", method: "GET" })
                .then(function (cardsData) {

                    //shuffle deck
                    cardsData.sort(
                         function () {
                             return 0.5 - Math.random()
                         }
                     );

                    //references html div.cardReading
                    var cardReading = $("#cardReading");

                    //empties div so function can run more than once without refreshing
                    cardReading.empty();

                    //iterates through first three cards in shuffled deck
                    for (var i = 0; i < 3; i++) {
                        var card = cardsData[i];

                        
                        //iterates through our nested image array
                        for (var j = 0; j < 1; j++) {

                            var cardItem = $("<div class= 'cardItem col-md-10 mx-auto'>");

                            var display = card.img[Math.floor(Math.random() * card.img.length)];

                            function appendCards() {
                                cardItem.append(
                                    $("<img>").addClass("cardImage col-md-3").attr("src", display.image),
                                    $("<div>").addClass("description col-md-5").append("<h3>"+card.name+"</h3><br>" + "<p>"+ display.description +"</p>")
                                );

                                cardReading.append(cardItem);
                            }

                        }
                        appendCards();
                        console.log(display);
                        
                    }
                    console.log(cardsData);
                })
        }
        runCardsQuery();
    })

    /*  function aboutCards(){
         if(display = card.img[0]){
             console.log(card.description[0])
            }
         else if(display = card.img[1]){
             console.log(card.description[1])
            }
            };
        aboutCards();   */
</script>

</html>