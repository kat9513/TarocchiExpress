<!DOCTYPE html>
<html>

<head>
    <title>Tarocchi</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="https://fonts.googleapis.com/css?family=Belleza|Rambla&display=swap" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="./assets/style.css">
</head>

<body>
            <div class="intro">
                <p class="intro1">
                    Welcome to the world of Tarot!
                </p>
                <p class="intro2">
                    The word Tarot is derived from the Italian
                </p>
                <p class="intro3">
                    Tarocchi
                </p>
            </div>
            <div class="about">
                <p class="about1">
                    Though the origins of the cards are
                    disputed the earliest documentation of tarot packs are recorded from Northern Italy
                    in the mid-Quattrocento or the early Renaissance.
                    <img class="players" src="imgs/TheTarocchiPlayer.jpg">
                </p>
                <br />
                <div class="moreAbout">
                    <div class="moreAboutText">
                        <p class="about2" style="line-height: 150%;">
                            These early tarot packs would have been hand painted for the purpose of gaming, with little
                            mysticism in the minds of their creators. It was not until
                            the 18th century that the use of tarot decks for cartomancy became widespread, and that they
                            developed a new association with the occult.
                        </p>
                        <br />
                        <p class="about3" style="line-height: 150%;">
                            There are many holes in the story of how tarot came to be associated with divination, but
                            their
                            enigmatic origins and charming illustrations will no doubt continue captivating us for years
                            to
                            come.
                        </p>
                    </div>

                    <div class="thumbnails">
                        <img class="tarotCard" src="imgs/tarot2.jpg" alt="">
                        <img class="tarotCard" src="imgs/tarot1.jpg" alt="">
                        <img class="tarotCard" src="imgs/tarot3.jpg" alt="">
                    </div>

                </div>
                <p class="aboutButton">
                    To receive a tarot reading of your own, try this button and scroll below!
                </p>
                <button class="btn" id="submit">Click For a Reading</button>
            </div>
        <div class="cards">
            <div class="cardReading">
                <!--card reading appears here-->
            </div>
        </div>
    </div>
    <footer class="footer">
        <a class="apiLink" href="/api/cards">Card API</a>
    </footer>

</body>

<script src="https://code.jquery.com/jquery-3.4.0.js" integrity="sha256-DYZMCC8HTC+QDr5QNaIcfR7VSPtcISykd+6eSmBW5qo="
    crossorigin="anonymous">
    </script>

<script type="text/javascript">

    $("#submit").on("click", function () {
        function runCardsQuery() {
            $.ajax({ url: "/api/cards", method: "GET" })
                .then(function (cardsData) {

                    //shuffle deck
                    cardsData.sort(
                        function () {
                            return 0.5 - Math.random()
                        }
                    );

                    //references html div.cardReading
                    var cardReading = $(".cardReading");

                    //empties div so function can run more than once without refreshing
                    cardReading.empty();

                    //iterates through first three cards in shuffled deck
                    for (var i = 0; i < 3; i++) {
                        var card = cardsData[i];


                        //iterates through our nested image array
                        for (var j = 0; j < 1; j++) {

                            var cardItem = $("<div class= 'cardItem'>");

                            var display = card.img[Math.floor(Math.random() * card.img.length)];

                            function appendCards() {
                                cardItem.append(
                                    $("<img>").addClass("cardImage").attr("src", display.image),
                                    $("<div>").addClass("description").append("<h3 class='title'>" + card.name + "</h3><br>" + "<p class='meaning'>" + display.description + "</p>"),
                                );

                                cardReading.append(cardItem);
                            }

                        }
                        appendCards();
                        console.log(display);

                    }
                    console.log(cardsData);
                })
        }
        runCardsQuery();
    })
</script>

</html>